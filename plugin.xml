<?xml version="1.0" encoding="UTF-8"?>
<plugin xmlns="http://www.phonegap.com/ns/plugins/1.0"
    xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:amazon="http://schemas.amazon.com/apk/res/android" 
    id="com.magikbee.plugins.cordova-adm-push-plugin"
    version="2.5.0">

  <name>PushPlugin</name>
	<author>Magikbee</author>

	<description>
		This plugin allows your application to receive push notifications on Android - Amazon FireOS
	</description>

	<license>MIT</license>

	<js-module src="www/PushNotification.js" name="PushNotification">
        <clobbers target="PushNotification" />
	</js-module>

	<engines>
        <engine name="cordova" version=">=3.5.0"/>
        <engine name="cordova-android" version=">=3.5.0"/>
        <engine name="cordova-ios" version=">=3.5.0"/>
	</engines>
    <!-- amazon-fireos -->
	<platform name="android">
		<config-file target="res/xml/config.xml" parent="/*">
			<feature name="PushPlugin" >
				<param name="android-package" value="com.amazon.cordova.plugin.PushPlugin"/>
			</feature>
            <preference name="showmessageinnotification" value="true" />
            <preference name="defaultnotificationmessage" value="You have a new message." />
		</config-file>

        <config-file target="AndroidManifest.xml" parent="/manifest">
            <!-- This permission ensures that no other application can intercept your ADM messages. "[YOUR PACKAGE NAME]" is your package name as defined in your <manifest> tag. -->
            <permission android:name="$PACKAGE_NAME.permission.RECEIVE_ADM_MESSAGE" android:protectionLevel="signature" />
            <uses-permission android:name="$PACKAGE_NAME.permission.RECEIVE_ADM_MESSAGE" />
            <!-- This permission allows your app access to receive push notifications from ADM. -->
            <uses-permission android:name="com.amazon.device.messaging.permission.RECEIVE" />
            <!-- ADM uses WAKE_LOCK to keep the processor from sleeping when a message is received. -->
            <uses-permission android:name="android.permission.WAKE_LOCK" />
		</config-file>

		<config-file target="AndroidManifest.xml" parent="/manifest/application">
            <!-- You must explicitly enable ADM and declare whether your app cannot work without ADM (android:required="true") or can work without ADM (android:required="false").
            If you specify android:required="false", your app must degrade gracefully if ADM
            is unavailable. -->
            <amazon:enable-feature android:name="com.amazon.device.messaging" android:required="true"/>
			<service android:exported="false" android:name="com.amazon.cordova.plugin.ADMMessageHandler" />
            <activity android:exported="true" android:name="com.amazon.cordova.plugin.ADMHandlerActivity" />
            <receiver android:name="com.amazon.cordova.plugin.ADMMessageHandler$Receiver" android:permission="com.amazon.device.messaging.permission.SEND">
                <intent-filter>
                    <action android:name="com.amazon.device.messaging.intent.REGISTRATION" />
                    <action android:name="com.amazon.device.messaging.intent.RECEIVE" />
                    <category android:name="$PACKAGE_NAME" />
                </intent-filter>
            </receiver>
            <!-- 
            Your application's API Key 
            TODO: PLACE THE API KEY HERE
            -->
            <meta-data android:name="AmazonAPIKey" android:value="eyJhbGciOiJSU0EtU0hBMjU2IiwidmVyIjoiMSJ9.eyJ2ZXIiOiIzIiwiZW5kcG9pbnRzIjp7ImF1dGh6IjoiaHR0cHM6Ly93d3cuYW1hem9uLmNvbS9hcC9vYSIsInRva2VuRXhjaGFuZ2UiOiJodHRwczovL2FwaS5hbWF6b24uY29tL2F1dGgvbzIvdG9rZW4ifSwiY2xpZW50SWQiOiJhbXpuMS5hcHBsaWNhdGlvbi1vYTItY2xpZW50LjY5YzMwMjAyZTIzNDQzZTBiNjc0YjU5ZGVmMzQ5NjdlIiwiYXBwRmFtaWx5SWQiOiJhbXpuMS5hcHBsaWNhdGlvbi5iNjg5MDIxMTY0Yjg0OWFhYjU0NmRlMGJlN2M0NTEwZiIsImlzcyI6IkFtYXpvbiIsInR5cGUiOiJBUElLZXkiLCJwa2ciOiJjb20ubWFnaWtiZWUua2lkZHp0dWJlbGl0ZSIsImFwcFZhcmlhbnRJZCI6ImFtem4xLmFwcGxpY2F0aW9uLWNsaWVudC45ZTZkOWRmYjZiMmQ0NDYyOWE0NTA5NWJjZTkyZjIyZiIsInRydXN0UG9vbCI6bnVsbCwiYXBwc2lnU2hhMjU2IjoiRkM6MTc6MkQ6RTY6RDc6QjY6QjM6RUM6RUI6MjI6REQ6MTU6N0E6QzM6ODM6REE6MkU6RjQ6N0U6RUM6MTM6MUQ6QjQ6NzI6N0Y6QTA6MkU6RkQ6QTU6RTM6QkU6QkYiLCJhcHBzaWciOiIwNTo1MzoyQzo5Qzo0ODo1RTo4MDo4NTozNjo3MDozQjozNDpDOTpDOTpCNjo4QiIsImFwcElkIjoiYW16bjEuYXBwbGljYXRpb24tY2xpZW50LjllNmQ5ZGZiNmIyZDQ0NjI5YTQ1MDk1YmNlOTJmMjJmIiwiaWQiOiI1NTllZTAyYi02ODQ4LTExZTktYjE4My05MTQxZDc3MzQyYjAiLCJpYXQiOiIxNTU2Mjk5NTQ5NDg4In0=.ChBlmu3Gn5jJBvU7EhO/I3yu1+cxRNzb9WDKVR9R/VEISU0m1W09OjgAF8h+vLdpzYcuViVM0H9mwg+5/TxGxv/Hx/62k3Wovylk3ewACb2FQVVawHld+9cv/aCO1GIIB0/ECiDxwdiT+GEUaSKOrp5B87zi3Qqjjjb8Cyb9k3euOOwK3UI0ZDnvM1Y1Ewjz3Ra7uitvOH7D/27desVx3GvbwtsrHHdzB9Mjj2CCWlkLDKrYixCpnxm0TBo7pzs/xpTL4O/IE6FTqpmJfSfOBboEpa6euJSlppNwG12hkMCPbudpqLeJ8yUa+gNbNE/Cj6q2IZ5vH8wBHv9ZdHRdhQ=="/>
        </config-file>
        
        <source-file src="ext-libs/amazon-device-messaging-1.0.1.jar"   target-dir="ext-libs"   framework="true" />
        <!-- <lib-file    src="ext-libs/amazon-device-messaging-1.0.1.jar" /> -->
        <source-file src="src/android/PushPlugin.java"                  target-dir="src/com/android/cordova/plugin" />
        <source-file src="src/android/ADMMessageHandler.java"           target-dir="src/com/android/cordova/plugin" />
        <source-file src="src/android/ADMHandlerActivity.java"          target-dir="src/com/android/cordova/plugin" />
        <!-- <framework   src="src/android/build.gradle"                     custom="true" type="gradleReference" /> -->
        <framework   src="build-extras.gradle"                          custom="true" type="gradleReference" />

	</platform>

</plugin>
